<!DOCTYPE html>
<html lang="en"><head><title>Message Broker ChatGPT Learnings</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Rubik:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Message Broker ChatGPT Learnings"/><meta property="og:description" content="In RabbitMQ, workers and consumers are related but not necessarily the same thing. Here’s the distinction: Consumer: A consumer in RabbitMQ refers to any application or service that subscribes to a queue and processes the messages from that queue."/><meta property="og:image" content="https://example.github.io/static/icon.jpg"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../../static/icon.jpg"/><meta name="description" content="In RabbitMQ, workers and consumers are related but not necessarily the same thing. Here’s the distinction: Consumer: A consumer in RabbitMQ refers to any application or service that subscribes to a queue and processes the messages from that queue."/><meta name="generator" content="Quartz"/><link href="../../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="notes/2024/Message-Broker-ChatGPT-Learnings"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><div class="spacer mobile-only"></div></div><div class="center"><div class="page-header"><div class="top-nav-wrapper"><div class="top-nav-wrapper"><div class="headshot"><img src="/static/icon.jpg" alt="My Profile"/></div><div class="desktop-only"><div class="flex header-links"><a class="header-link" href="/notes">Notes</a><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button><div class="search"><button class="search-button" id="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div></div></div></div><div class="popover-hint"><div class="mobile-only"><div class="top-nav"><div class="hamburger" id="hamburger"><span></span><span></span><span></span></div><div id="mobile-links" class="off-screen-menu"><div class="mobile-header-links"><a class="header-link" href="/notes">Notes</a><button class="darkmode" id="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button><div class="search"><button class="search-button" id="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div></div></div></div></div></div></div><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../notes/">notes</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../notes/2024/">2024</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Message Broker ChatGPT Learnings</a></div></nav><h1 class="article-title">Message Broker ChatGPT Learnings</h1><p show-comma="true" class="content-meta"><span>Sep 21, 2025</span><span>16 min read</span></p><ul class="tags"><li><a href="../../tags/message_broker" class="internal tag-link">message_broker</a></li><li><a href="../../tags/message_queues" class="internal tag-link">message_queues</a></li><li><a href="../../tags/backend" class="internal tag-link">backend</a></li></ul><div class="toc mobile-only"><button type="button" id="toc" class="collapsed" aria-controls="toc-content" aria-expanded="false"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content" class="collapsed"><ul class="overflow"><li class="depth-0"><a href="#summary" data-for="summary">Summary:</a></li><li class="depth-0"><a href="#1-producer" data-for="1-producer">1. Producer</a></li><li class="depth-0"><a href="#2-exchange" data-for="2-exchange">2. Exchange</a></li><li class="depth-0"><a href="#3-queue" data-for="3-queue">3. Queue</a></li><li class="depth-0"><a href="#4-binding" data-for="4-binding">4. Binding</a></li><li class="depth-0"><a href="#5-consumer" data-for="5-consumer">5. Consumer</a></li><li class="depth-0"><a href="#6-message" data-for="6-message">6. Message</a></li><li class="depth-0"><a href="#7-connection-and-channel" data-for="7-connection-and-channel">7. Connection and Channel</a></li><li class="depth-0"><a href="#8-virtual-host-vhost" data-for="8-virtual-host-vhost">8. Virtual Host (vhost)</a></li><li class="depth-0"><a href="#9-broker" data-for="9-broker">9. Broker</a></li><li class="depth-0"><a href="#10-routing-key" data-for="10-routing-key">10. Routing Key</a></li><li class="depth-0"><a href="#11-acknowledgment-ack" data-for="11-acknowledgment-ack">11. Acknowledgment (Ack)</a></li><li class="depth-0"><a href="#12-dead-letter-exchange-dlx" data-for="12-dead-letter-exchange-dlx">12. Dead Letter Exchange (DLX)</a></li><li class="depth-0"><a href="#13-prefetch-count" data-for="13-prefetch-count">13. Prefetch Count</a></li><li class="depth-0"><a href="#summary-diagram" data-for="summary-diagram">Summary Diagram:</a></li><li class="depth-0"><a href="#nodejs-example-using-direct-exchange-in-rabbitmq" data-for="nodejs-example-using-direct-exchange-in-rabbitmq">Node.js Example Using Direct Exchange in RabbitMQ</a></li><li class="depth-0"><a href="#installation" data-for="installation">Installation</a></li><li class="depth-0"><a href="#scenario" data-for="scenario">Scenario</a></li><li class="depth-0"><a href="#producer-code-sending-messages" data-for="producer-code-sending-messages">Producer Code (Sending Messages)</a></li><li class="depth-0"><a href="#consumer-code-receiving-messages" data-for="consumer-code-receiving-messages">Consumer Code (Receiving Messages)</a></li><li class="depth-0"><a href="#running-the-code" data-for="running-the-code">Running the Code</a></li><li class="depth-0"><a href="#1-start-consumers" data-for="1-start-consumers">1. Start Consumers</a></li><li class="depth-0"><a href="#2-send-messages-producer" data-for="2-send-messages-producer">2. Send Messages (Producer)</a></li><li class="depth-0"><a href="#explanation" data-for="explanation">Explanation</a></li><li class="depth-0"><a href="#example-output" data-for="example-output">Example Output</a></li><li class="depth-0"><a href="#producer" data-for="producer">Producer:</a></li><li class="depth-0"><a href="#consumer-error-queue" data-for="consumer-error-queue">Consumer (Error Queue):</a></li><li class="depth-0"><a href="#1-durable-queues" data-for="1-durable-queues">1. Durable Queues</a></li><li class="depth-0"><a href="#example" data-for="example">Example</a></li><li class="depth-0"><a href="#non-durable-queue" data-for="non-durable-queue">Non-Durable Queue:</a></li><li class="depth-0"><a href="#2-exclusive-queues" data-for="2-exclusive-queues">2. Exclusive Queues</a></li><li class="depth-0"><a href="#example-1" data-for="example-1">Example</a></li><li class="depth-0"><a href="#use-case" data-for="use-case">Use Case:</a></li><li class="depth-0"><a href="#3-auto-delete-queues" data-for="3-auto-delete-queues">3. Auto-Delete Queues</a></li><li class="depth-0"><a href="#example-2" data-for="example-2">Example</a></li><li class="depth-0"><a href="#use-case-1" data-for="use-case-1">Use Case:</a></li><li class="depth-0"><a href="#putting-it-together-with-a-full-example" data-for="putting-it-together-with-a-full-example">Putting It Together with a Full Example</a></li><li class="depth-0"><a href="#producer-code" data-for="producer-code">Producer Code:</a></li><li class="depth-0"><a href="#consumer-code" data-for="consumer-code">Consumer Code:</a></li><li class="depth-0"><a href="#behavior-breakdown" data-for="behavior-breakdown">Behavior Breakdown:</a></li><li class="depth-0"><a href="#example-output-1" data-for="example-output-1">Example Output</a></li><li class="depth-0"><a href="#summary-of-attributes" data-for="summary-of-attributes">Summary of Attributes:</a></li><li class="depth-0"><a href="#what-is-a-connection" data-for="what-is-a-connection">What is a Connection?</a></li><li class="depth-0"><a href="#what-is-a-channel" data-for="what-is-a-channel">What is a Channel?</a></li><li class="depth-0"><a href="#analogy" data-for="analogy">Analogy</a></li><li class="depth-0"><a href="#example-3" data-for="example-3">Example</a></li><li class="depth-0"><a href="#1-create-a-connection-and-channels-in-nodejs" data-for="1-create-a-connection-and-channels-in-nodejs">1. Create a Connection and Channels in Node.js</a></li><li class="depth-0"><a href="#step-1-install-amqplib-if-you-havent-already" data-for="step-1-install-amqplib-if-you-havent-already">Step 1: Install amqplib if you haven’t already</a></li><li class="depth-0"><a href="#step-2-producer-and-consumer-example" data-for="step-2-producer-and-consumer-example">Step 2: Producer and Consumer Example</a></li><li class="depth-0"><a href="#producer-send-messages-using-one-channel" data-for="producer-send-messages-using-one-channel">Producer (Send messages using one channel)</a></li><li class="depth-0"><a href="#consumer-receive-messages-using-a-different-channel" data-for="consumer-receive-messages-using-a-different-channel">Consumer (Receive messages using a different channel)</a></li><li class="depth-0"><a href="#whats-happening" data-for="whats-happening">What’s Happening?</a></li><li class="depth-0"><a href="#why-use-channels" data-for="why-use-channels">Why Use Channels?</a></li><li class="depth-0"><a href="#practical-example" data-for="practical-example">Practical Example:</a></li><li class="depth-0"><a href="#summary-1" data-for="summary-1">Summary:</a></li></ul></div></div></div></div><article class="popover-hint"><p>In RabbitMQ, <strong>workers</strong> and <strong>consumers</strong> are related but not necessarily the same thing. Here’s the distinction:</p>
<ol>
<li><strong>Consumer</strong>:
<ul>
<li>A <strong>consumer</strong> in RabbitMQ refers to any application or service that subscribes to a queue and processes the messages from that queue. When a consumer connects to RabbitMQ and subscribes to a queue, RabbitMQ delivers messages to the consumer. Each message is acknowledged (either automatically or manually) after being processed.</li>
<li><strong>Consumers</strong> can be a part of any service that processes messages from queues, such as a web service, background job processor, or any application that needs to handle asynchronous tasks.</li>
</ul>
</li>
<li><strong>Worker</strong>:
<ul>
<li>A <strong>worker</strong> is often used in the context of <strong>worker queues</strong> or <strong>background job processing</strong>. It refers to a process (or thread) that does the actual work of processing a message. A worker pulls messages off a queue and handles them, typically performing some computation or task before acknowledging the message.</li>
<li>In many setups, a <strong>worker</strong> acts as a <strong>consumer</strong>. However, the term <strong>worker</strong> generally emphasizes the processing task being done by the service, while <strong>consumer</strong> is the RabbitMQ term for the entity receiving messages.</li>
</ul>
</li>
</ol>
<h3 id="summary">Summary:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#summary" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>worker</strong> often plays the role of a <strong>consumer</strong>, but <strong>consumer</strong> is the more accurate term in the RabbitMQ context, specifically referring to the service that consumes messages from the queue.</li>
<li>The term <strong>worker</strong> is more common in job processing systems and emphasizes the work being done after consuming the message.</li>
</ul>
<h3 id="1-producer">1. <strong>Producer</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-producer" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>producer</strong> is a user application that sends messages to the RabbitMQ broker. The producer doesn’t directly interact with queues but rather with <strong>exchanges</strong>.</li>
<li>Producers publish messages to an exchange, and it is the exchange’s responsibility to route the message to the appropriate queue(s).</li>
</ul>
<h3 id="2-exchange">2. <strong>Exchange</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-exchange" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>An <strong>exchange</strong> is responsible for routing messages to one or more queues. When a message is sent to RabbitMQ, it is sent to an exchange first, not directly to a queue.</li>
<li>There are different types of exchanges, which determine how messages are routed:
<ul>
<li><strong>Direct Exchange</strong>: Routes messages to queues based on an exact match between the message’s routing key and the queue’s binding key.</li>
<li><strong>Topic Exchange</strong>: Routes messages to queues based on pattern matching of the routing key (wildcards like “ or <code>#</code> can be used).</li>
<li><strong>Fanout Exchange</strong>: Broadcasts messages to all queues bound to the exchange, regardless of the routing key.</li>
<li><strong>Headers Exchange</strong>: Routes messages based on matching message headers rather than routing keys.</li>
</ul>
</li>
</ul>
<h3 id="3-queue">3. <strong>Queue</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-queue" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>queue</strong> is where messages are stored until they are consumed by a <strong>consumer</strong>. Queues in RabbitMQ are FIFO (first in, first out).</li>
<li>Queues are bound to exchanges, and the exchange determines which messages are routed to which queue based on routing rules.</li>
<li>Queues can have various attributes, such as being durable (persisted to disk), exclusive (restricted to one connection), or auto-delete (deleted when no consumers are connected).</li>
</ul>
<h3 id="4-binding">4. <strong>Binding</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#4-binding" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>binding</strong> defines the relationship between an exchange and a queue. It specifies how messages sent to the exchange should be routed to the queue.</li>
<li>A binding key is often used in direct and topic exchanges to determine which messages should be delivered to which queues.</li>
</ul>
<h3 id="5-consumer">5. <strong>Consumer</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#5-consumer" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>consumer</strong> is an application that retrieves and processes messages from a queue.</li>
<li>Consumers subscribe to queues, and RabbitMQ delivers messages from the queue to the consumer. Once the message is processed, the consumer typically sends an acknowledgment (ack) back to RabbitMQ.</li>
</ul>
<h3 id="6-message">6. <strong>Message</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#6-message" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>message</strong> in RabbitMQ consists of two parts:
<ul>
<li><strong>Message Body</strong>: The content or payload being transmitted (e.g., JSON, XML, plain text).</li>
<li><strong>Message Properties/Headers</strong>: Metadata associated with the message, such as delivery mode, expiration time, or custom headers.</li>
</ul>
</li>
</ul>
<h3 id="7-connection-and-channel">7. <strong>Connection and Channel</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#7-connection-and-channel" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>connection</strong> is a TCP connection between the producer/consumer and the RabbitMQ broker.</li>
<li>A <strong>channel</strong> is a virtual connection that runs over a single TCP connection. Channels are lightweight and can be used to multiplex multiple logical conversations (publishing, consuming) over a single connection, which is resource-efficient.</li>
</ul>
<h3 id="8-virtual-host-vhost">8. <strong>Virtual Host (vhost)</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#8-virtual-host-vhost" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>virtual host</strong> is a way to logically separate different applications using the same RabbitMQ instance. Each virtual host can have its own set of queues, exchanges, and bindings.</li>
<li>It allows for multi-tenancy within a RabbitMQ broker by providing isolated environments for different applications.</li>
</ul>
<h3 id="9-broker">9. <strong>Broker</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#9-broker" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>The <strong>broker</strong> is the RabbitMQ server itself. It receives messages from producers, routes them through exchanges to queues, and delivers them to consumers. It also handles message persistence, delivery acknowledgment, and clustering for fault tolerance and scalability.</li>
</ul>
<h3 id="10-routing-key">10. <strong>Routing Key</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#10-routing-key" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>routing key</strong> is used by the producer when sending a message to an exchange. The routing key, in combination with the exchange type, determines how the message should be routed to one or more queues.</li>
</ul>
<h3 id="11-acknowledgment-ack">11. <strong>Acknowledgment (Ack)</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#11-acknowledgment-ack" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Acknowledgment</strong> is the confirmation sent by a consumer to RabbitMQ indicating that the message was received and processed successfully.</li>
<li>If a message is not acknowledged (Nack or rejected), RabbitMQ can either requeue it for another consumer to process or discard it based on the queue settings.</li>
</ul>
<h3 id="12-dead-letter-exchange-dlx">12. <strong>Dead Letter Exchange (DLX)</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#12-dead-letter-exchange-dlx" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>A <strong>Dead Letter Exchange</strong> is used to capture messages that are rejected or not processed (e.g., due to expiration or consumer failure).</li>
<li>Queues can be configured to route unprocessed messages to a DLX for further inspection or reprocessing.</li>
</ul>
<h3 id="13-prefetch-count">13. <strong>Prefetch Count</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#13-prefetch-count" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Prefetch count</strong> controls how many messages RabbitMQ sends to a consumer at a time without receiving an acknowledgment. It is part of the quality-of-service (QoS) mechanism to avoid overloading consumers.</li>
</ul>
<hr/>
<h3 id="summary-diagram">Summary Diagram:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#summary-diagram" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Producer → Exchange → Queue → Consumer</strong></li>
<li><strong>Binding</strong> connects <strong>Exchange</strong> to <strong>Queue</strong>, and <strong>Routing Key</strong> helps with the routing decision.</li>
</ul>
<p>Each of these abstractions allows developers to work with RabbitMQ’s messaging system in a flexible and decoupled manner, building complex and scalable messaging patterns.</p>
<h3 id="nodejs-example-using-direct-exchange-in-rabbitmq">Node.js Example Using Direct Exchange in RabbitMQ<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#nodejs-example-using-direct-exchange-in-rabbitmq" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Here’s a step-by-step example using Node.js with the <code>amqplib</code> package, demonstrating how to set up a <strong>Direct Exchange</strong>.</p>
<h3 id="installation">Installation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#installation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>First, install the <code>amqplib</code> package in your Node.js project:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amqplib</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="scenario">Scenario<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#scenario" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Exchange Name</strong>: <code>direct_logs</code></li>
<li><strong>Queues</strong>: <code>errorQueue</code>, <code>infoQueue</code>, <code>warningQueue</code></li>
<li><strong>Routing Keys</strong>:
<ul>
<li>Messages with the routing key <code>error</code> will go to the <code>errorQueue</code>.</li>
<li>Messages with the routing key <code>info</code> will go to the <code>infoQueue</code>.</li>
<li>Messages with the routing key <code>warning</code> will go to the <code>warningQueue</code>.</li>
</ul>
</li>
</ul>
<h3 id="producer-code-sending-messages">Producer Code (Sending Messages)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#producer-code-sending-messages" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>The producer will send messages to the <code>direct_logs</code> exchange with different routing keys (<code>error</code>, <code>info</code>, <code>warning</code>).</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> amqp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqplib'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> produceMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> connection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amqp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqp://localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> channel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exchange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'direct_logs'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> msg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.argv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">slice</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">' '</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Hello World!'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> severity</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> process.argv[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'info'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// severity represents routing key (e.g., 'info', 'error')</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Declare an exchange</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertExchange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(exchange, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'direct'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      durable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Publish message to the exchange with a specific routing key</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">publish</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(exchange, severity, Buffer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msg));</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`[x] Sent ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">severity</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}: '${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}'`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Close the connection and channel</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'Error in producer:'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, error);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">produceMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="consumer-code-receiving-messages">Consumer Code (Receiving Messages)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#consumer-code-receiving-messages" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>The consumer will listen to the <code>direct_logs</code> exchange and bind different queues with specific routing keys (<code>error</code>, <code>info</code>, <code>warning</code>).</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> amqp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqplib'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> consumeMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">routingKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  try</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> connection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amqp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqp://localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> channel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exchange</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'direct_logs'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Declare an exchange</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertExchange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(exchange, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'direct'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { durable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Create a queue with a unique name for each consumer</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> q</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">''</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { exclusive: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`[x] Waiting for messages in ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">q</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">queue</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}. To exit press CTRL+C`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Bind the queue to the exchange with the specified routing key</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bindQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(q.queue, exchange, routingKey);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Consume messages</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">consume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(q.queue, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (msg.content) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`[x] Received ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">routingKey</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}: ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">content</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }, { noAck: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">catch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (error) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'Error in consumer:'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, error);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Pass 'error', 'info', or 'warning' as the routing key you want to listen to</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">consumeMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(process.argv[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'info'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="running-the-code">Running the Code<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#running-the-code" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h3 id="1-start-consumers">1. Start Consumers<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-start-consumers" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Each consumer will listen to a different routing key. Open multiple terminals and run the consumer for different keys:</p>
<ul>
<li>Terminal 1 (Listening for <code>error</code> messages):</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> consumer.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error</span></span></code></pre></figure>
<ul>
<li>Terminal 2 (Listening for <code>info</code> messages):</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> consumer.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info</span></span></code></pre></figure>
<ul>
<li>Terminal 3 (Listening for <code>warning</code> messages):</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> consumer.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> warning</span></span></code></pre></figure>
<h3 id="2-send-messages-producer">2. Send Messages (Producer)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-send-messages-producer" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Send different messages with various routing keys. Open another terminal and run the producer:</p>
<ul>
<li>Send an <code>info</code> message:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">   node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> producer.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;This is an info message&quot;</span></span></code></pre></figure>
<ul>
<li>Send an <code>error</code> message:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> producer.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> error</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;This is an error message&quot;</span></span></code></pre></figure>
<ul>
<li>Send a <code>warning</code> message:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	node</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> producer.js</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> warning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;This is a warning message&quot;</span></span></code></pre></figure>
<h3 id="explanation">Explanation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#explanation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>The <strong>Producer</strong> sends messages to the <code>direct_logs</code> exchange with a specific routing key (<code>info</code>, <code>error</code>, <code>warning</code>).</li>
<li>The <strong>Consumers</strong> are bound to the same exchange (<code>direct_logs</code>) but are listening for different routing keys.
<ul>
<li>One consumer listens for <code>info</code> messages.</li>
<li>Another listens for <code>error</code> messages.</li>
<li>Another listens for <code>warning</code> messages.</li>
</ul>
</li>
</ul>
<p>Only the consumer with a matching routing key will receive the corresponding message.</p>
<h3 id="example-output">Example Output<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-output" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h3 id="producer">Producer:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#producer" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[x] Sent error: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'This is an error message</span></span></code></pre></figure>
<h3 id="consumer-error-queue">Consumer (Error Queue):<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#consumer-error-queue" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[x] Received error: This is an error message</span></span>
<span data-line> </span></code></pre></figure>
<p>Similarly, the other consumers will only receive messages matching their routing key.</p>
<p>This demonstrates a <strong>Direct Exchange</strong> where messages are routed based on specific routing keys.</p>
<h3 id="1-durable-queues">1. <strong>Durable Queues</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-durable-queues" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>A <strong>durable</strong> queue ensures that the queue itself survives broker restarts. This means that even if RabbitMQ crashes or is restarted, the queue will still exist and retain any messages that were not yet delivered.</p>
<h3 id="example">Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>You declare a <strong>durable queue</strong> so that it will persist even if RabbitMQ restarts:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'my_durable_queue'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { durable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></figure>
<ul>
<li>If RabbitMQ is restarted, the queue will still be available, though any <strong>non-persistent</strong> messages in the queue may be lost (depending on how they were published).</li>
<li><strong>Persistent messages</strong> will be stored to disk if you set the message to be persistent:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendToQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'my_durable_queue'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Buffer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'This is a message'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), { persistent: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line> </span></code></pre></figure>
<ul>
<li>In this case, both the queue and messages will survive a restart.</li>
</ul>
<h3 id="non-durable-queue">Non-Durable Queue:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#non-durable-queue" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>If you set <code>{ durable: false }</code>, the queue will be deleted when RabbitMQ restarts, and all the messages in it will be lost.</p>
<h3 id="2-exclusive-queues">2. <strong>Exclusive Queues</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-exclusive-queues" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>An <strong>exclusive</strong> queue is restricted to the connection that declared it. Only this connection can use the queue, and the queue will be deleted when the connection is closed.</p>
<h3 id="example-1">Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>Declaring an <strong>exclusive queue</strong>:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'my_exclusive_queue'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { exclusive: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line> </span></code></pre></figure>
<ul>
<li>The queue will only be accessible by the connection that declared it. If you open another connection, it won’t be able to access this queue.</li>
<li>When the connection that created the queue is closed, the queue is automatically deleted.</li>
</ul>
<h3 id="use-case">Use Case:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#use-case" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Exclusive queues are useful in cases where you want to ensure that only one instance of a consumer (or application) uses the queue. This is typically for temporary queues where you don’t need persistence or multiple consumers.</p>
<h3 id="3-auto-delete-queues">3. <strong>Auto-Delete Queues</strong><a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-auto-delete-queues" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>An <strong>auto-delete</strong> queue is automatically deleted when its last consumer unsubscribes or disconnects from it. The queue exists as long as there is at least one consumer consuming messages, but once the last consumer disconnects, the queue is deleted.</p>
<h3 id="example-2">Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-2" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li>Declaring an <strong>auto-delete queue</strong>:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'my_auto_delete_queue'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, { autoDelete: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line> </span></code></pre></figure>
<ul>
<li>When all consumers are disconnected, RabbitMQ will delete the queue.</li>
<li>If a consumer connects again later, they must declare the queue again because it will no longer exist.</li>
</ul>
<h3 id="use-case-1">Use Case:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#use-case-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Auto-delete queues are useful for temporary or ephemeral messaging setups, such as real-time chat systems or job queues, where you don’t need the queue to persist if there are no active consumers.</p>
<hr/>
<h3 id="putting-it-together-with-a-full-example">Putting It Together with a Full Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#putting-it-together-with-a-full-example" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Let’s say you want to create a <strong>durable</strong>, <strong>exclusive</strong>, and <strong>auto-delete</strong> queue:</p>
<h3 id="producer-code">Producer Code:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#producer-code" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> amqp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqplib'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> produceMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> connection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amqp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqp://localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> channel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Declare a queue with all three attributes: durable, exclusive, and auto-delete</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> queue</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'my_special_queue'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(queue, {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    durable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Queue survives broker restarts</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    exclusive: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,    </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Only accessible by the current connection</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    autoDelete: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Deleted when no consumers are connected</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> msg</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'Hello World!'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sendToQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(queue, Buffer.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msg), { persistent: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`[x] Sent '${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}'`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">close</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">produceMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="consumer-code">Consumer Code:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#consumer-code" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="javascript" data-theme="github-light github-dark"><code data-language="javascript" data-theme="github-light github-dark" style="display:grid;"><span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> amqp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqplib'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> consumeMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> connection</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> amqp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">connect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'amqp://localhost'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> channel</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> connection.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createChannel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> queue</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 'my_special_queue'</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Declare the same queue, consumers should match the declaration</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">assertQueue</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(queue, {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    durable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    exclusive: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    autoDelete: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`Waiting for messages in ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">queue</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Start consuming messages from the queue</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  channel.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">consume</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(queue, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=></span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">`[x] Received: ${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">msg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">content</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">()</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }, { noAck: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">consumeMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="behavior-breakdown">Behavior Breakdown:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#behavior-breakdown" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li><strong>Durable</strong>:
<ul>
<li>If RabbitMQ restarts, the queue will still exist because it is <strong>durable</strong>.</li>
<li>Messages will survive if they were marked as <strong>persistent</strong> (<code>persistent: true</code> in the message options).</li>
</ul>
</li>
<li><strong>Exclusive</strong>:
<ul>
<li>Only the connection that declared the queue will have access to it. If a second producer or consumer tries to access the same queue, it will receive an error.</li>
<li>If the connection that declared the queue closes, the queue is automatically deleted.</li>
</ul>
</li>
<li><strong>Auto-Delete</strong>:
<ul>
<li>If the consumer disconnects (closes its connection), RabbitMQ will automatically delete the queue because it has no more consumers.</li>
<li>If a new consumer wants to consume from this queue later, they would need to re-declare it because it no longer exists.</li>
</ul>
</li>
</ol>
<h3 id="example-output-1">Example Output<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-output-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Producer</strong>:</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[x] Sent </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">'Hello World!'</span></span>
<span data-line> </span></code></pre></figure>
<ul>
<li><strong>Consumer</strong> (when receiving a message):</li>
</ul>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Waiting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> messages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my_special_queue</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[x] Received: Hello World</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span></span>
<span data-line> </span></code></pre></figure>
<p>Once the consumer disconnects, the queue will be deleted automatically if it’s the last consumer.</p>
<h3 id="summary-of-attributes">Summary of Attributes:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#summary-of-attributes" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Durable</strong>: Ensures the queue survives RabbitMQ restarts.</li>
<li><strong>Exclusive</strong>: Restricts the queue to a single connection and deletes it when the connection closes.</li>
<li><strong>Auto-Delete</strong>: Automatically deletes the queue when no consumers are connected.</li>
</ul>
<p>These attributes are helpful in designing different messaging patterns depending on the persistence and exclusivity requirements of your application.</p>
<h3 id="what-is-a-connection">What is a <strong>Connection</strong>?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#what-is-a-connection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>A <strong>connection</strong> in RabbitMQ is a TCP connection between your application (producer/consumer) and the RabbitMQ broker (the server). It’s like having a direct link to RabbitMQ.</p>
<ul>
<li>Each connection requires system resources (like memory and CPU) to manage, so opening many connections can be expensive.</li>
<li>Typically, you open <strong>one connection</strong> per application.</li>
</ul>
<h3 id="what-is-a-channel">What is a <strong>Channel</strong>?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#what-is-a-channel" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>A <strong>channel</strong> is a <strong>virtual connection</strong> that runs on top of a single <strong>TCP connection</strong>. Channels allow you to do multiple things (like publishing messages and consuming messages) over a single connection without creating additional connections.</p>
<ul>
<li><strong>Channels are lightweight</strong> and can be created very quickly.</li>
<li>You can open <strong>multiple channels</strong> on a single connection, allowing you to publish and consume messages without creating extra TCP connections. This is more efficient than opening multiple TCP connections.</li>
</ul>
<h3 id="analogy">Analogy<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#analogy" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Imagine a <strong>connection</strong> is like a <strong>highway</strong>. You build one big highway (TCP connection) between your application and RabbitMQ. Opening multiple highways would be costly (using more system resources).</p>
<p>A <strong>channel</strong> is like an individual <strong>lane</strong> on the highway. Multiple lanes (channels) can be used to handle different traffic (publishing or consuming messages) without building new highways. Each lane (channel) can carry different cars (messages) at the same time.</p>
<h3 id="example-3">Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-3" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Let’s create a RabbitMQ setup using a single connection but two channels: one for <strong>producing</strong> messages and one for <strong>consuming</strong> messages.</p>
<h3 id="1-create-a-connection-and-channels-in-nodejs">1. Create a Connection and Channels in Node.js<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-create-a-connection-and-channels-in-nodejs" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Here’s an example in Node.js using the <code>amqplib</code> package:</p>
<h3 id="step-1-install-amqplib-if-you-havent-already">Step 1: Install <code>amqplib</code> if you haven’t already<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#step-1-install-amqplib-if-you-havent-already" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Copy</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> code</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> amqplib</span></span>
<span data-line> </span></code></pre></figure>
<h3 id="step-2-producer-and-consumer-example">Step 2: Producer and Consumer Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#step-2-producer-and-consumer-example" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>In this example, we will create:</p>
<ul>
<li>A <strong>single connection</strong>.</li>
<li>Two <strong>channels</strong>: one for sending (producer), one for receiving (consumer).</li>
</ul>
<h3 id="producer-send-messages-using-one-channel">Producer (Send messages using one channel)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#producer-send-messages-using-one-channel" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<pre><code>js
Copy code
const amqp = require('amqplib');

async function producer() {
  try {
    // Open a connection
    const connection = await amqp.connect('amqp://localhost');

    // Create a channel (lane) for publishing messages
    const channel = await connection.createChannel();

    const queue = 'test_queue';
    const msg = 'Hello, RabbitMQ!';

    // Assert a queue (make sure it exists)
    await channel.assertQueue(queue, { durable: false });

    // Send a message to the queue
    channel.sendToQueue(queue, Buffer.from(msg));
    console.log(`[x] Sent: ${msg}`);

    // Close the connection after a short delay to ensure message is sent
    setTimeout(() => {
      channel.close();
      connection.close();
    }, 500);

  } catch (error) {
    console.error('Producer error:', error);
  }
}

producer();

</code></pre>
<h3 id="consumer-receive-messages-using-a-different-channel">Consumer (Receive messages using a different channel)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#consumer-receive-messages-using-a-different-channel" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<pre><code>js
Copy code
const amqp = require('amqplib');

async function consumer() {
  try {
    // Open a connection (same as the producer)
    const connection = await amqp.connect('amqp://localhost');

    // Create a separate channel (lane) for consuming messages
    const channel = await connection.createChannel();

    const queue = 'test_queue';

    // Assert a queue (make sure it exists)
    await channel.assertQueue(queue, { durable: false });

    // Start consuming messages from the queue
    console.log(`[x] Waiting for messages in ${queue}`);
    channel.consume(queue, (msg) => {
      console.log(`[x] Received: ${msg.content.toString()}`);
    }, { noAck: true });

  } catch (error) {
    console.error('Consumer error:', error);
  }
}

consumer();

</code></pre>
<h3 id="whats-happening">What’s Happening?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#whats-happening" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li><strong>Connection</strong>:
<ul>
<li>Both the producer and consumer use <strong>the same TCP connection</strong> to RabbitMQ.</li>
</ul>
</li>
<li><strong>Channels</strong>:
<ul>
<li>In the producer, we created a <strong>channel</strong> to publish a message to RabbitMQ.</li>
<li>In the consumer, we created another <strong>channel</strong> to receive messages from RabbitMQ.</li>
<li>Both channels are running over the same connection, but they handle different tasks (publishing vs consuming).</li>
</ul>
</li>
</ol>
<h3 id="why-use-channels">Why Use Channels?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#why-use-channels" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>If you didn’t use channels and instead created a new connection for every action (publishing and consuming), you would:</p>
<ul>
<li>Have more overhead due to opening and maintaining multiple TCP connections.</li>
<li>Consume more system resources (CPU, memory, etc.).</li>
</ul>
<p>Using <strong>channels</strong> allows multiple independent conversations (like publishing and consuming) to happen <strong>over a single TCP connection</strong>, which is more efficient.</p>
<h3 id="practical-example">Practical Example:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#practical-example" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Scenario</strong>: You have a web server that processes data and sends it to RabbitMQ.</li>
<li>Instead of opening a new TCP connection every time you want to send or receive data, you open a single TCP connection and use multiple <strong>channels</strong> for different purposes:
<ul>
<li>One channel to <strong>publish messages</strong> (like sending new tasks).</li>
<li>Another channel to <strong>consume messages</strong> (like processing tasks).</li>
</ul>
</li>
</ul>
<h3 id="summary-1">Summary:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#summary-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Connection</strong>: A TCP connection between your application and RabbitMQ. It’s heavier and resource-intensive.</li>
<li><strong>Channel</strong>: A lightweight, virtual connection that runs on top of a TCP connection. You can create multiple channels on a single connection to handle different tasks like publishing and consuming messages.</li>
</ul>
<p>In this example, you used one connection but two channels — one for sending messages and one for receiving them, making the system more resource-efficient.</p></article><hr/><div class="page-footer"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><button id="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div></div></div><div class="right sidebar"><div class="toc desktop-only"><button type="button" id="toc" class="collapsed" aria-controls="toc-content" aria-expanded="false"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content" class="collapsed"><ul class="overflow"><li class="depth-0"><a href="#summary" data-for="summary">Summary:</a></li><li class="depth-0"><a href="#1-producer" data-for="1-producer">1. Producer</a></li><li class="depth-0"><a href="#2-exchange" data-for="2-exchange">2. Exchange</a></li><li class="depth-0"><a href="#3-queue" data-for="3-queue">3. Queue</a></li><li class="depth-0"><a href="#4-binding" data-for="4-binding">4. Binding</a></li><li class="depth-0"><a href="#5-consumer" data-for="5-consumer">5. Consumer</a></li><li class="depth-0"><a href="#6-message" data-for="6-message">6. Message</a></li><li class="depth-0"><a href="#7-connection-and-channel" data-for="7-connection-and-channel">7. Connection and Channel</a></li><li class="depth-0"><a href="#8-virtual-host-vhost" data-for="8-virtual-host-vhost">8. Virtual Host (vhost)</a></li><li class="depth-0"><a href="#9-broker" data-for="9-broker">9. Broker</a></li><li class="depth-0"><a href="#10-routing-key" data-for="10-routing-key">10. Routing Key</a></li><li class="depth-0"><a href="#11-acknowledgment-ack" data-for="11-acknowledgment-ack">11. Acknowledgment (Ack)</a></li><li class="depth-0"><a href="#12-dead-letter-exchange-dlx" data-for="12-dead-letter-exchange-dlx">12. Dead Letter Exchange (DLX)</a></li><li class="depth-0"><a href="#13-prefetch-count" data-for="13-prefetch-count">13. Prefetch Count</a></li><li class="depth-0"><a href="#summary-diagram" data-for="summary-diagram">Summary Diagram:</a></li><li class="depth-0"><a href="#nodejs-example-using-direct-exchange-in-rabbitmq" data-for="nodejs-example-using-direct-exchange-in-rabbitmq">Node.js Example Using Direct Exchange in RabbitMQ</a></li><li class="depth-0"><a href="#installation" data-for="installation">Installation</a></li><li class="depth-0"><a href="#scenario" data-for="scenario">Scenario</a></li><li class="depth-0"><a href="#producer-code-sending-messages" data-for="producer-code-sending-messages">Producer Code (Sending Messages)</a></li><li class="depth-0"><a href="#consumer-code-receiving-messages" data-for="consumer-code-receiving-messages">Consumer Code (Receiving Messages)</a></li><li class="depth-0"><a href="#running-the-code" data-for="running-the-code">Running the Code</a></li><li class="depth-0"><a href="#1-start-consumers" data-for="1-start-consumers">1. Start Consumers</a></li><li class="depth-0"><a href="#2-send-messages-producer" data-for="2-send-messages-producer">2. Send Messages (Producer)</a></li><li class="depth-0"><a href="#explanation" data-for="explanation">Explanation</a></li><li class="depth-0"><a href="#example-output" data-for="example-output">Example Output</a></li><li class="depth-0"><a href="#producer" data-for="producer">Producer:</a></li><li class="depth-0"><a href="#consumer-error-queue" data-for="consumer-error-queue">Consumer (Error Queue):</a></li><li class="depth-0"><a href="#1-durable-queues" data-for="1-durable-queues">1. Durable Queues</a></li><li class="depth-0"><a href="#example" data-for="example">Example</a></li><li class="depth-0"><a href="#non-durable-queue" data-for="non-durable-queue">Non-Durable Queue:</a></li><li class="depth-0"><a href="#2-exclusive-queues" data-for="2-exclusive-queues">2. Exclusive Queues</a></li><li class="depth-0"><a href="#example-1" data-for="example-1">Example</a></li><li class="depth-0"><a href="#use-case" data-for="use-case">Use Case:</a></li><li class="depth-0"><a href="#3-auto-delete-queues" data-for="3-auto-delete-queues">3. Auto-Delete Queues</a></li><li class="depth-0"><a href="#example-2" data-for="example-2">Example</a></li><li class="depth-0"><a href="#use-case-1" data-for="use-case-1">Use Case:</a></li><li class="depth-0"><a href="#putting-it-together-with-a-full-example" data-for="putting-it-together-with-a-full-example">Putting It Together with a Full Example</a></li><li class="depth-0"><a href="#producer-code" data-for="producer-code">Producer Code:</a></li><li class="depth-0"><a href="#consumer-code" data-for="consumer-code">Consumer Code:</a></li><li class="depth-0"><a href="#behavior-breakdown" data-for="behavior-breakdown">Behavior Breakdown:</a></li><li class="depth-0"><a href="#example-output-1" data-for="example-output-1">Example Output</a></li><li class="depth-0"><a href="#summary-of-attributes" data-for="summary-of-attributes">Summary of Attributes:</a></li><li class="depth-0"><a href="#what-is-a-connection" data-for="what-is-a-connection">What is a Connection?</a></li><li class="depth-0"><a href="#what-is-a-channel" data-for="what-is-a-channel">What is a Channel?</a></li><li class="depth-0"><a href="#analogy" data-for="analogy">Analogy</a></li><li class="depth-0"><a href="#example-3" data-for="example-3">Example</a></li><li class="depth-0"><a href="#1-create-a-connection-and-channels-in-nodejs" data-for="1-create-a-connection-and-channels-in-nodejs">1. Create a Connection and Channels in Node.js</a></li><li class="depth-0"><a href="#step-1-install-amqplib-if-you-havent-already" data-for="step-1-install-amqplib-if-you-havent-already">Step 1: Install amqplib if you haven’t already</a></li><li class="depth-0"><a href="#step-2-producer-and-consumer-example" data-for="step-2-producer-and-consumer-example">Step 2: Producer and Consumer Example</a></li><li class="depth-0"><a href="#producer-send-messages-using-one-channel" data-for="producer-send-messages-using-one-channel">Producer (Send messages using one channel)</a></li><li class="depth-0"><a href="#consumer-receive-messages-using-a-different-channel" data-for="consumer-receive-messages-using-a-different-channel">Consumer (Receive messages using a different channel)</a></li><li class="depth-0"><a href="#whats-happening" data-for="whats-happening">What’s Happening?</a></li><li class="depth-0"><a href="#why-use-channels" data-for="why-use-channels">Why Use Channels?</a></li><li class="depth-0"><a href="#practical-example" data-for="practical-example">Practical Example:</a></li><li class="depth-0"><a href="#summary-1" data-for="summary-1">Summary:</a></li></ul></div></div></div><footer class><p>Build with ♥ Sanjay V © 2025</p><ul><li><a href="https://github.com/sanjay2024">GitHub</a></li><li><a href="https://www.linkedin.com/in/sanjay2024/">Linkedin</a></li><li><a href="https://x.com/sanjayv22318195">Twitter</a></li></ul></footer></div></div></body><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">
        const socket = new WebSocket('ws://localhost:3001')
        // reload(true) ensures resources like images and scripts are fetched again in firefox
        socket.addEventListener('message', () => document.location.reload(true))
      </script><script src="../../postscript.js" type="module"></script></html>